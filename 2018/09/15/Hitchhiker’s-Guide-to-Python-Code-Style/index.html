<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>Hitchhiker&#39;s Guide to Python-Code Style | Yo42 | Dont&#39;t Panic,Do not go gentle into that good night~</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Technology">
    <meta name="description" content="如果有人问起 Python 程序员他们最喜欢 Python 哪一点，他们一定会提到 Python 的高可读性。确实，对于 Python 来说，其高可读性一直是 Python 这门语言设计的核心。一个不争的事实是，相对于写代码而言，读代码才是更加平常的事情。 Python 代码有高可读性的一个原因就是其有着相对而言更加完善的编码风格准则和 「Python化」习语。 当 Python 老手（Pytho">
<meta name="keywords" content="Technology">
<meta property="og:type" content="article">
<meta property="og:title" content="Hitchhiker&#39;s Guide to Python-Code Style">
<meta property="og:url" content="https://yo42.github.io/2018/09/15/Hitchhiker’s-Guide-to-Python-Code-Style/index.html">
<meta property="og:site_name" content="Yo42">
<meta property="og:description" content="如果有人问起 Python 程序员他们最喜欢 Python 哪一点，他们一定会提到 Python 的高可读性。确实，对于 Python 来说，其高可读性一直是 Python 这门语言设计的核心。一个不争的事实是，相对于写代码而言，读代码才是更加平常的事情。 Python 代码有高可读性的一个原因就是其有着相对而言更加完善的编码风格准则和 「Python化」习语。 当 Python 老手（Pytho">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-09-15T09:43:15.538Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hitchhiker&#39;s Guide to Python-Code Style">
<meta name="twitter:description" content="如果有人问起 Python 程序员他们最喜欢 Python 哪一点，他们一定会提到 Python 的高可读性。确实，对于 Python 来说，其高可读性一直是 Python 这门语言设计的核心。一个不争的事实是，相对于写代码而言，读代码才是更加平常的事情。 Python 代码有高可读性的一个原因就是其有着相对而言更加完善的编码风格准则和 「Python化」习语。 当 Python 老手（Pytho">
    
        <link rel="alternate" type="application/atom+xml" title="Yo42" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/yo.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Yo</h5>
          <a href="mailto:edyo7024@gmail.com" title="edyo7024@gmail.com" class="mail">edyo7024@gmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                Home
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://yo42.github.io/Aobut-Me/"  >
                <i class="icon icon-lg icon-user"></i>
                About Me
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Hitchhiker&#39;s Guide to Python-Code Style</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Hitchhiker&#39;s Guide to Python-Code Style</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-09-15T04:38:05.984Z" itemprop="datePublished" class="page-time">
  2018-09-15
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Technology/">Technology</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#一般概念"><span class="post-toc-number">1.</span> <span class="post-toc-text">一般概念</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#明确代码意义"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">明确代码意义</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#一行一个声明语句"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">一行一个声明语句</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#函数的参数"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">函数的参数</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#避免魔法方法"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">避免魔法方法</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#我们都是负责任的用户"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">我们都是负责任的用户</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#返回值"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">返回值</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#习语（Idiom）"><span class="post-toc-number">2.</span> <span class="post-toc-text">习语（Idiom）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#解包（Unpacking）"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">解包（Unpacking）</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#创建一个被忽略的变量"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">创建一个被忽略的变量</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#注意"><span class="post-toc-number">2.2.1.</span> <span class="post-toc-text">注意</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#创建一个含-N-个对象的列表"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">创建一个含 N 个对象的列表</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#创建一个含-N-个列表的列表"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">创建一个含 N 个列表的列表</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#根据列表来创建字符串"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">根据列表来创建字符串</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#在集合体（collection）中查找一个项"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">在集合体（collection）中查找一个项</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Python之禅"><span class="post-toc-number">3.</span> <span class="post-toc-text">Python之禅</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#PEP-8"><span class="post-toc-number">4.</span> <span class="post-toc-text">PEP 8</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#约定"><span class="post-toc-number">5.</span> <span class="post-toc-text">约定</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#检查变量是否等于常量"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">检查变量是否等于常量</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#访问字典元素"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">访问字典元素</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#操作列表的简便方法"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">操作列表的简便方法</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#读文件"><span class="post-toc-number">5.4.</span> <span class="post-toc-text">读文件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#行的延续"><span class="post-toc-number">5.5.</span> <span class="post-toc-text">行的延续</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#参考资料"><span class="post-toc-number">6.</span> <span class="post-toc-text">参考资料</span></a></li></ol>
        </nav>
    </aside>


<article id="post-Hitchhiker’s-Guide-to-Python-Code-Style"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Hitchhiker's Guide to Python-Code Style</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-09-15 12:38:05" datetime="2018-09-15T04:38:05.984Z"  itemprop="datePublished">2018-09-15</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Technology/">Technology</a></li></ul>



            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>如果有人问起 Python 程序员他们最喜欢 Python 哪一点，他们一定会提到 Python 的高可读性。确实，对于 Python 来说，其高可读性一直是 Python 这门语言设计的核心。一个不争的事实是，相对于写代码而言，读代码才是更加平常的事情。</p>
<p>Python 代码有高可读性的一个原因就是其有着相对而言更加完善的编码风格准则和 「Python化」习语。</p>
<p>当 Python 老手（Pythonista）认为一段代码不「Python化」，他们通常的意思是这段代码没有遵循一般准则，同时亦没有以最佳的（最具可读性的）方式表达出代码的意图。</p>
<p>在一些极端的情况下，没有公认最佳的方式来表达 Python 代码的意图，不过这种极端情况非常罕见。</p>
<h2 id="一般概念"><a href="#一般概念" class="headerlink" title="一般概念"></a>一般概念</h2><h3 id="明确代码意义"><a href="#明确代码意义" class="headerlink" title="明确代码意义"></a>明确代码意义</h3><p>尽管 Python 可以写出从各种意义上来说都像是黑魔法的代码，但最简单直白的表达才是正道。</p>
<p><strong>不好</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def make_complex(*args):</span><br><span class="line">    x, y = args</span><br><span class="line">    <span class="keyword">return</span> dict(**locals())</span><br></pre></td></tr></table></figure>
<p><strong>好</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def make_complex(x, y):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">'x'</span>: x, <span class="string">'y'</span>: y&#125;</span><br></pre></td></tr></table></figure>
<p>在上述好的代码中，x 和 y 清晰明了的从参数中获取值，并清晰明了的返回了一个字典。当开发者看到这个函数后就可以明了这个函数的用途，而不好的代码则不行。</p>
<h3 id="一行一个声明语句"><a href="#一行一个声明语句" class="headerlink" title="一行一个声明语句"></a>一行一个声明语句</h3><p>虽然在 Python 中我们推崇使用形如列表生成式这种简洁明了的复合语句，但是除此以外，我们应该尽量避免将两句独立分割的代码写在同一行。</p>
<p><strong>不好的风格</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">'one'</span>; <span class="keyword">print</span> <span class="string">'two'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> x == <span class="number">1</span>: <span class="keyword">print</span> <span class="string">'one'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> &lt;complex comparison&gt; <span class="keyword">and</span> &lt;other complex comparison&gt;:</span><br><span class="line">    <span class="comment"># do something</span></span><br></pre></td></tr></table></figure>
<p><strong>好的风格</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">'one'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'two'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> x == <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'one'</span></span><br><span class="line"></span><br><span class="line">cond1 = &lt;complex comparison&gt;</span><br><span class="line">cond2 = &lt;other complex comparison&gt;</span><br><span class="line"><span class="keyword">if</span> cond1 <span class="keyword">and</span> cond2:</span><br><span class="line">    <span class="comment"># do something</span></span><br></pre></td></tr></table></figure>
<h3 id="函数的参数"><a href="#函数的参数" class="headerlink" title="函数的参数"></a>函数的参数</h3><p>函数的参数可以使用四种不同的方式传递给函数。</p>
<ol>
<li><strong>必选参数</strong> 是没有默认值的必填的参数。 必选参数是最简单的参数构成，用于参数较少的函数的构成，是该函数意义的一部分，使用他们的顺序是按照定义自然排序的。举个例子，对于 <code>send(message, recipient)</code> 和  <code>point(x, y)</code> 这两个函数，使用函数的人需要知道这个函数需要两个参数，并且记住两个参数的顺序。</li>
</ol>
<p>在调用函数的时候，我们也可以使用参数的名称调用。使用参数的名称的方式可以调换参数的顺序，就像 <code>send(recipient=&#39;World&#39;,message=&#39;Hello&#39;)</code> 和 <code>point(y=2, x=1)</code> 这样。但这样的做法会降低代码的可读性，并且使代码冗长，因此更建议使用 <code>send(&#39;Hello&#39;, &#39;World&#39;)</code> 和<code>point(1,2)</code> 这样的方式调用。</p>
<ol>
<li><strong>关键字参数</strong> 是非强制的，且有默认值。它们经常被用在传递给函数的可选参数中。 当一个函数有超过两个或三个位置参数时，函数签名会变得难以记忆，使用带有默认参数的关键字参数有时候会给你带来便利。比如，一个更完整的 <code>send</code> 函数可以被定义为<code>send(message, to, cc=None, bcc=None)</code>。这里的 <code>cc</code> 和 <code>bcc</code> 是可选的， 当没有传递给它们其他值的时候，它们的值就是 None。</li>
</ol>
<p>Python 中有多种方式调用带关键字参数的函数。比如说，我们可以按照定义时的参数顺序而无需明确的命名参数来调用函数，就像 <code>send(&#39;Hello&#39;, &#39;World&#39;, &#39;Cthulhu&#39;, &#39;God&#39;)</code> 是将密件发送给上帝。我们也可以使用命名参数而无需遵循参数顺序来调用函数，就像<code>send(&#39;Hello again&#39;, &#39;World&#39;, bcc=&#39;God&#39;, cc=&#39;Cthulhu&#39;)</code> 。没有特殊情况的话，这两种方式都需要尽力避免，最优的调用方式是与定义方式一致：<code>send(&#39;Hello&#39;, &#39;World&#39;, cc=&#39;Cthulhu&#39;,bcc=&#39;God&#39;)</code> 。</p>
<p>作为附注，请遵循 <a href="http://en.wikipedia.org/wiki/You_ain&#39;t_gonna_need_it" target="_blank" rel="noopener">YAGNI</a> 原则。 通常，移除一个用作『以防万一』但从未使用的可选参数（以及它在函数中的逻辑），比添加一个所需的新的可选参数和它的逻辑要来的困难。</p>
<ol>
<li><strong>任意参数列表</strong> 是第三种给函数传参的方式。如果函数的参数数量是动态的，该函数可以被定义成 <code>*args</code> 的结构。在这个函数体中， <code>args</code> 是一个元组，它包含所有剩余的位置参数。举个例子， 我们可以用任何容器作为参数去调用 <code>send(message, *args)</code> ，比如 <code>send(&#39;Hello&#39;, &#39;God&#39;, &#39;Mom&#39;,&#39;Cthulhu&#39;)</code>。 在此函数体中， <code>args</code> 相当于 <code>(&#39;God&#39;,&#39;Mom&#39;, &#39;Cthulhu&#39;)</code>。</li>
</ol>
<p>然而，这种结构有一些缺点，使用时应该特别注意。如果一个函数接受的参数列表具有相同的性质，通常把它定义成一个参数，这个参数是一个列表或者其他任何序列会更清晰。 在这里，如果 <code>send</code> 参数有多个容器（recipients），将之定义成 <code>send(message,recipients)</code> 会更明确，调用它时就使用 <code>send(&#39;Hello&#39;, [&#39;God&#39;, &#39;Mom&#39;, &#39;Cthulhu&#39;])</code>。这样的话， 函数的使用者可以事先将容器列表维护成列表（list）形式，这为传递各种不能被转变成其他序列的序列（包括迭代器）带来了可能。</p>
<ol>
<li><strong>任意关键字参数字典</strong> 是最后一种给函数传参的方式。如果函数要求一系列待定的命名参数，我们可以使用 <code>**kwargs</code> 的结构。在函数体中， <code>kwargs</code> 是一个字典，它包含所有传递给函数但没有被其他关键字参数捕捉的命名参数。</li>
</ol>
<p>和 <strong>任意参数列表</strong> 中所需注意的一样，相似的原因是：这些强大的技术在非特殊情况下，都要尽量避免使用，因为其缺乏简单和明确的结构来足够表达函数意图。</p>
<p>编写函数的时候采用何种参数形式，是用位置参数，还是可选关键字参数，是否使用形如任意参数 的高级技术，这些都由程序员自己决定。如果能明智地遵循上述建议，即可轻松写出这样的 Python 函数：</p>
<ul>
<li>易读（名字和参数无需解释）</li>
<li>易改（添加新的关键字参数不会破坏代码的其他部分）</li>
</ul>
<h3 id="避免魔法方法"><a href="#避免魔法方法" class="headerlink" title="避免魔法方法"></a>避免魔法方法</h3><p>Python 对骇客来说是一个强有力的工具，它拥有非常丰富的钩子（hook）和工具，允许你施展几乎任何形式的技巧。比如说，它能够做以下：</p>
<ul>
<li>改变对象创建和实例化的方式；</li>
<li>改变 Python 解释器导入模块的方式；</li>
<li>甚至可能（如果需要的话也是被推荐的）在 Python 中嵌入 C 程序。</li>
</ul>
<p>尽管如此，所有的这些选择都有许多缺点。使用最直接的方式来达成目标通常是最好的方法。它们最主要的缺点是可读性不高。许多代码分析工具，比如说 pylint 或者 pyflakes，将无法解析这种『魔法』代码。</p>
<p>我们认为 Python 开发者应该知道这些近乎无限的可能性，因为它为我们灌输了没有不可能完成的任务的信心。然而，知道何时 <strong>不能</strong> 使用它们也是非常重要的。</p>
<p>就像一位功夫大师，一个 Pythonista 知道如何用一个手指杀死对方，但从不会那么去做。</p>
<h3 id="我们都是负责任的用户"><a href="#我们都是负责任的用户" class="headerlink" title="我们都是负责任的用户"></a>我们都是负责任的用户</h3><p>如前所述，Python 允许很多技巧，其中一些具有潜在的危险。一个好的例子是：任何客户端代码能够重写一个对象的属性和方法（Python 中没有 <code>private</code> 关键字）。这种哲学是在说：『我们都是负责任的用户』，它和高度防御性的语言（如 Java，拥有很多机制来预防错误操作）有着非常大的不同。</p>
<p>这并不意味着，比如说，Python 中没有属性是私有的，也不意味着没有合适的封装方法。 与其依赖在开发者的代码之间树立起的一道道隔墙，Python 社区更愿意依靠一组约定，来表明这些元素不应该被直接访问。</p>
<p>私有属性的主要约定和实现细节是在所有的 <strong>内部</strong> 变量前加一个下划线。如果客户端代码打破了这条规则并访问了带有下划线的变量，那么因内部代码的改变而出现的任何不当的行为或问题，都是客户端代码的责任。</p>
<p>鼓励大方地使用此约定：<strong>任何不开放给客户端代码使用的方法或属性，应该有一个下划线前缀</strong>。这将保证更好的职责划分以及更容易对已有代码进行修改。将一个私有属性公开化总是可能的，但是把一个公共属性私有化可能是一个更难的选择。</p>
<h3 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h3><p>当一个函数变得复杂，在函数体中使用多返回值的语句并不少见。然而，为了保持函数的可读性，建议在函数体中避免使用返回多个有意义的值。</p>
<p>在函数中返回结果主要有两种情况：函数正常运行并返回它的结果，以及错误的情况，要么因为一个错误的输入参数，要么因为其他导致函数无法完成计算或任务的原因。</p>
<p>如果你在面对第二种情况时不想抛出异常，返回一个值（比如说 None 或 False ）来表明函数无法正确运行，可能是需要的。在这种情况下，越早返回所发现的不正确上下文越好。 这将帮助扁平化函数的结构：我们假定在『因为错误而返回』的语句后的所有代码都能够满足函数主要结果运算。这种类型的多发挥结果，是有必要的。</p>
<p>然而，当一个函数在其正常运行过程中有多个主要出口点时，它会变得难以调试其返回结果，所以保持单个出口点可能会更好。这也将有助于提取某些代码路径，而且多个出口点很有可能意味着这里需要重构：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def complex_function(a, b, c):</span><br><span class="line">    <span class="keyword">if</span> not a:</span><br><span class="line">        <span class="keyword">return</span> None  <span class="comment"># 抛出一个异常可能会更好</span></span><br><span class="line">    <span class="keyword">if</span> not b:</span><br><span class="line">        <span class="keyword">return</span> None  <span class="comment"># 抛出一个异常可能会更好</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 一些复杂的代码试着用 a,b,c 来计算x</span></span><br><span class="line">    <span class="comment"># 如果成功了，抵制住返回 x 的诱惑</span></span><br><span class="line">    <span class="keyword">if</span> not x:</span><br><span class="line">        <span class="comment"># 使用其他的方法来计算出 x</span></span><br><span class="line">    <span class="keyword">return</span> x  <span class="comment"># 返回值 x 只有一个出口点有利于维护代码</span></span><br></pre></td></tr></table></figure>
<h2 id="习语（Idiom）"><a href="#习语（Idiom）" class="headerlink" title="习语（Idiom）"></a>习语（Idiom）</h2><p>编程习语，说得简单些，就是写代码的 <strong>方式</strong>。编程习语的概念在 <a href="http://c2.com/cgi/wiki?ProgrammingIdiom" target="_blank" rel="noopener">c2</a> 和 <a href="http://stackoverflow.com/questions/302459/what-is-a-programming-idiom" target="_blank" rel="noopener">Stack Overflow</a> 上有详尽的讨论。</p>
<p>符合习语的 Python 代码通常被称为 <strong>Pythonic</strong>。</p>
<p>通常只有一种、而且最好只有一种明显的方式去编写代码。对 Python 初学者来说，无意识的情况下很少能写出习语式 Python 代码，所以应该有意识地去获取习语的书写方式。</p>
<p>如下有一些常见的Python习语：</p>
<h3 id="解包（Unpacking）"><a href="#解包（Unpacking）" class="headerlink" title="解包（Unpacking）"></a>解包（Unpacking）</h3><p>如果你知道一个列表或者元组的长度，你可以将其解包并为它的元素取名。比如，<code>enumerate()</code> 会对 list 中的每个项提供包含两个元素的元组：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> index, item in enumerate(some_list):</span><br><span class="line">    <span class="comment"># do something with index and item</span></span><br></pre></td></tr></table></figure>
<p>你也能通过这种方式交换变量：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a, b = b, a</span><br></pre></td></tr></table></figure>
<p>嵌套解包也能工作：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a, (b, c) = <span class="number">1</span>, (<span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>Python 3 提供了扩展解包的新方法在 <a href="https://www.python.org/dev/peps/pep-3132" target="_blank" rel="noopener"><strong>PEP 3132</strong></a> 有介绍：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a, *rest = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment"># a = 1, rest = [2, 3]</span></span><br><span class="line">a, *middle, c = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="comment"># a = 1, middle = [2, 3], c = 4</span></span><br></pre></td></tr></table></figure>
<h3 id="创建一个被忽略的变量"><a href="#创建一个被忽略的变量" class="headerlink" title="创建一个被忽略的变量"></a>创建一个被忽略的变量</h3><p>如果你需要赋值（比如，在 <a href="http://pythonguidecn.readthedocs.io/zh/latest/writing/style.html#unpacking-ref" target="_blank" rel="noopener">解包（Unpacking）</a> ）但不需要这个变量，请使用 <code>__</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">filename = <span class="string">'foobar.txt'</span></span><br><span class="line">basename, __, ext = filename.rpartition(<span class="string">'.'</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><p>许多 Python 风格指南建议使用单下划线的 <code>_</code> 而不是这里推荐的双下划线 <code>__</code> 来标记废弃变量。问题是， <code>_</code> 常用在作为 <a href="http://docs.python.org/library/gettext.html#gettext.gettext" target="_blank" rel="noopener"><code>gettext()</code></a> 函数的别名，也被用在交互式命令行中记录最后一次操作的值。相反，使用双下划线 十分清晰和方便，而且能够消除使用其他这些用例所带来的意外干扰的风险。</p>
</blockquote>
<h3 id="创建一个含-N-个对象的列表"><a href="#创建一个含-N-个对象的列表" class="headerlink" title="创建一个含 N 个对象的列表"></a>创建一个含 N 个对象的列表</h3><p>使用 Python 列表中的 <code>*</code> 操作符：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">four_nones = [None] * <span class="number">4</span></span><br></pre></td></tr></table></figure>
<h3 id="创建一个含-N-个列表的列表"><a href="#创建一个含-N-个列表的列表" class="headerlink" title="创建一个含 N 个列表的列表"></a>创建一个含 N 个列表的列表</h3><p>因为列表是可变的，所以 <code>*</code> 操作符（如上）将会创建一个包含 N 个且指向 <strong>同一个</strong> 列表的列表，这可能不是你想用的。取而代之，请使用列表解析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">four_lists = [[] <span class="keyword">for</span> __ in xrange(<span class="number">4</span>)]</span><br></pre></td></tr></table></figure>
<p>注意：在 Python 3 中使用 <code>range()</code> 而不是 <code>xrange()</code>。</p>
<h3 id="根据列表来创建字符串"><a href="#根据列表来创建字符串" class="headerlink" title="根据列表来创建字符串"></a>根据列表来创建字符串</h3><p>创建字符串的一个常见习语是在空的字符串上使用 <a href="http://docs.python.org/library/stdtypes.html#str.join" target="_blank" rel="noopener"><code>str.join()</code></a> ：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">letters = [<span class="string">'s'</span>, <span class="string">'p'</span>, <span class="string">'a'</span>, <span class="string">'m'</span>]</span><br><span class="line">word = <span class="string">''</span>.join(letters)</span><br></pre></td></tr></table></figure>
<p>这会将 <strong>word</strong> 变量赋值为 <code>spam</code>。这个习语可以用在列表和元组中。</p>
<h3 id="在集合体（collection）中查找一个项"><a href="#在集合体（collection）中查找一个项" class="headerlink" title="在集合体（collection）中查找一个项"></a>在集合体（collection）中查找一个项</h3><p>有时我们需要在集合体中查找。让我们看看这两个选择，列表和集合（set），用如下代码举个例子：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">s = set([<span class="string">'s'</span>, <span class="string">'p'</span>, <span class="string">'a'</span>, <span class="string">'m'</span>])</span><br><span class="line">l = [<span class="string">'s'</span>, <span class="string">'p'</span>, <span class="string">'a'</span>, <span class="string">'m'</span>]</span><br><span class="line"></span><br><span class="line">def lookup_set(s):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'s'</span> in s</span><br><span class="line"></span><br><span class="line">def lookup_list(l):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'s'</span> in l</span><br></pre></td></tr></table></figure>
<p>即使两个函数看起来完全一样，但因为 <strong>查找集合</strong> 是利用了 Python 中的『集合是可哈希』的特性，两者的查询性能是非常不同的。为了判断一个项是否在列表中，Python 将会查看每个项直到它找到匹配的项。这是耗时的任务，尤其是对长列表而言。另一方面，在集合中， 项的哈希值将会告诉 Python 在集合的哪里去查找匹配的项。结果是，即使集合很大，查询的速度也很快。在字典中查询也是同样的原理。想了解更多内容，请见 <a href="http://stackoverflow.com/questions/513882/python-list-vs-dict-for-look-up-table" target="_blank" rel="noopener">StackOverflow</a> 。想了解在每种数据结构上的多种常见操作的花费时间的详细内容， 请见 <a href="https://wiki.python.org/moin/TimeComplexity?" target="_blank" rel="noopener">此页面</a>。</p>
<p>因为这些性能上的差异，在下列场景中，使用集合或者字典而不是列表，通常会是个好主意：</p>
<ul>
<li>集合体中包含大量的项；</li>
<li>你将在集合体中重复地查找项；</li>
<li>你没有重复的项。</li>
</ul>
<p>对于小的集合体、或者你不会频繁查找的集合体，建立哈希带来的额外时间和内存的开销经常会大过改进搜索速度所节省的时间。</p>
<h2 id="Python之禅"><a href="#Python之禅" class="headerlink" title="Python之禅"></a>Python之禅</h2><p>又名 <a href="https://www.python.org/dev/peps/pep-0020" target="_blank" rel="noopener"><strong>PEP 20</strong></a>, 是 Python 设计的指导原则。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import this</span><br><span class="line">The Zen of Python, by Tim Peters</span><br><span class="line"></span><br><span class="line">Beautiful is better than ugly.</span><br><span class="line">Explicit is better than implicit.</span><br><span class="line">Simple is better than complex.</span><br><span class="line">Complex is better than complicated.</span><br><span class="line">Flat is better than nested.</span><br><span class="line">Sparse is better than dense.</span><br><span class="line">Readability counts.</span><br><span class="line">Special cases aren<span class="string">'t special enough to break the rules.</span></span><br><span class="line"><span class="string">Although practicality beats purity.</span></span><br><span class="line"><span class="string">Errors should never pass silently.</span></span><br><span class="line"><span class="string">Unless explicitly silenced.</span></span><br><span class="line"><span class="string">In the face of ambiguity, refuse the temptation to guess.</span></span><br><span class="line"><span class="string">There should be one-- and preferably only one --obvious way to do it.</span></span><br><span class="line"><span class="string">Although that way may not be obvious at first unless you'</span>re Dutch.</span><br><span class="line">Now is better than never.</span><br><span class="line">Although never is often better than *right* now.</span><br><span class="line"><span class="keyword">If</span> the implementation is hard to explain, it<span class="string">'s a bad idea.</span></span><br><span class="line"><span class="string">If the implementation is easy to explain, it may be a good idea.</span></span><br><span class="line"><span class="string">Namespaces are one honking great idea -- let'</span>s <span class="keyword">do</span> more of those!</span><br><span class="line"></span><br><span class="line">Python之禅 by Tim Peters</span><br><span class="line"></span><br><span class="line">优美胜于丑陋（Python 以编写优美的代码为目标）</span><br><span class="line">明了胜于晦涩（优美的代码应当是明了的，命名规范，风格相似）</span><br><span class="line">简洁胜于复杂（优美的代码应当是简洁的，不要有复杂的内部实现）</span><br><span class="line">复杂胜于凌乱（如果复杂不可避免，那代码间也不能有难懂的关系，要保持接口简洁）</span><br><span class="line">扁平胜于嵌套（优美的代码应当是扁平的，不能有太多的嵌套）</span><br><span class="line">间隔胜于紧凑（优美的代码有适当的间隔，不要奢望一行代码解决问题）</span><br><span class="line">可读性很重要（优美的代码是具备高可读性的）</span><br><span class="line">即便假借特例的实用性之名，也不可违背这些规则（这些规则至高无上）</span><br><span class="line">不要包容所有错误，除非您确定需要这样做（精准地捕获异常，不写 `except:pass` 风格的代码）</span><br><span class="line">当存在多种可能，不要尝试去猜测</span><br><span class="line">而是尽量找一种，最好是唯一一种明显的解决方案（如果不确定，就用穷举法）</span><br><span class="line">虽然这并不容易，因为您不是 Python 之父（这里的 Dutch 是指 Guido ）</span><br><span class="line">做也许好过不做，但不假思索就动手还不如不做（动手之前要细思量）</span><br><span class="line">如果您无法向人描述您的方案，那肯定不是一个好方案；反之亦然（方案测评标准）</span><br><span class="line">命名空间是一种绝妙的理念，我们应当多加利用（倡导与号召）</span><br></pre></td></tr></table></figure>
<p>想要了解一些 Python 优雅风格的例子，请见 <a href="http://artifex.org/~hblanks/talks/2011/pep20_by_example.pdf" target="_blank" rel="noopener">这些来自于 Python 用户的幻灯片</a>。</p>
<h2 id="PEP-8"><a href="#PEP-8" class="headerlink" title="PEP 8"></a>PEP 8</h2><p><a href="https://www.python.org/dev/peps/pep-0008" target="_blank" rel="noopener"><strong>PEP 8</strong></a> 是 Python 实际意义上的代码风格指南，我们可以在 <a href="http://pep8.org/" target="_blank" rel="noopener">pep8.org</a> 上获得高质量的、可读性更高的 PEP 8 版本。</p>
<p>强烈推荐阅读这部分。整个 Python 社区都尽力遵循本文档中规定的准则。这其中，一些项目可能受其影响， 而其他项目可能 <a href="http://docs.python-equests.org/en/master/dev/contributing/kenneth-reitz-s-code-style" target="_blank" rel="noopener">修改其建议</a>。</p>
<p>也就是说，让你的 Python 代码遵循 PEP 8 通常是个好主意，这也有助于在与其他开发人员 一起工作时使代码更加具一致性。命令行程序 pycodestyle <a href="https://github.com/PyCQA/pycodestyle" target="_blank" rel="noopener">https://github.com/PyCQA/pycodestyle</a> （以前叫做<code>pep8</code>），可以检查代码一致性。在你的终端上运行以下命令来安装它：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install pycodestyle</span><br></pre></td></tr></table></figure>
<p>然后，对一个文件或者一系列的文件运行它，来获得任何违规行为的报告：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ pycodestyle optparse.py</span><br><span class="line">optparse.py:<span class="number">69</span>:<span class="number">11</span>: E401 multiple imports on one line</span><br><span class="line">optparse.py:<span class="number">77</span>:<span class="number">1</span>: E302 expected <span class="number">2</span> blank lines, found <span class="number">1</span></span><br><span class="line">optparse.py:<span class="number">88</span>:<span class="number">5</span>: E301 expected <span class="number">1</span> blank line, found <span class="number">0</span></span><br><span class="line">optparse.py:<span class="number">222</span>:<span class="number">34</span>: W602 deprecated form of raising <span class="keyword">exception</span></span><br><span class="line">optparse.py:<span class="number">347</span>:<span class="number">31</span>: E211 whitespace before <span class="string">'('</span></span><br><span class="line">optparse.py:<span class="number">357</span>:<span class="number">17</span>: E201 whitespace after <span class="string">'&#123;'</span></span><br><span class="line">optparse.py:<span class="number">472</span>:<span class="number">29</span>: E221 multiple spaces before operator</span><br><span class="line">optparse.py:<span class="number">544</span>:<span class="number">21</span>: W601 .has_key() is deprecated, <span class="keyword">use</span> '<span class="title">in</span>'</span><br></pre></td></tr></table></figure>
<p>程序 <a href="https://pypi.python.org/pypi/autopep8/" target="_blank" rel="noopener">autopep8</a> 能自动将代码格式化成 PEP 8 风格。用以下指令安装此程序：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install autopep8</span><br></pre></td></tr></table></figure>
<p>用以下指令格式化一个文件：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ autopep8 --in-place optparse.py</span><br></pre></td></tr></table></figure>
<p>不包含 <code>--in-place</code> 标志将会使得程序直接将更改的代码输出到控制台，以供审查。 <code>--aggressive</code> 标志则会执行更多实质性的变化，而且可以多次使用以达到更佳的效果。</p>
<h2 id="约定"><a href="#约定" class="headerlink" title="约定"></a>约定</h2><p>这里有一些你应该遵循的约定，以让你的代码更加易读。</p>
<h3 id="检查变量是否等于常量"><a href="#检查变量是否等于常量" class="headerlink" title="检查变量是否等于常量"></a>检查变量是否等于常量</h3><p>你不需要明确地比较一个值是 True，或者 None，或者 0 - 你可以仅仅把它放在 <code>if</code> 语句中。 参阅 <a href="http://docs.python.org/library/stdtypes.html#truth-value-testing" target="_blank" rel="noopener">真值测试</a> 来了解什么被认为是 false：</p>
<p><strong>糟糕</strong>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> attr == <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'True!'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> attr == None:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'attr is None!'</span></span><br></pre></td></tr></table></figure>
<p><strong>优雅</strong>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查值</span></span><br><span class="line"><span class="keyword">if</span> attr:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'attr is truthy!'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者做相反的检查</span></span><br><span class="line"><span class="keyword">if</span> not attr:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'attr is falsey!'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者，None 等于 false，你可以直接相较它进行匹配</span></span><br><span class="line"><span class="keyword">if</span> attr is None:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'attr is None!'</span></span><br></pre></td></tr></table></figure>
<h3 id="访问字典元素"><a href="#访问字典元素" class="headerlink" title="访问字典元素"></a>访问字典元素</h3><p>不要使用 <code>dict.has_key()</code>方法。 相反，使用 <code>x in d</code> 语法，或者将默认参数传递给 <a href="http://docs.python.org/library/stdtypes.html#dict.get" target="_blank" rel="noopener"><code>dict.get()</code></a> 方法。</p>
<p><strong>坏的示例</strong>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">d = &#123;<span class="string">'hello'</span>: <span class="string">'world'</span>&#125;</span><br><span class="line"><span class="keyword">if</span> d.has_key(<span class="string">'hello'</span>):</span><br><span class="line">    <span class="keyword">print</span> d[<span class="string">'hello'</span>]    <span class="comment"># prints 'world'</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'default_value'</span></span><br></pre></td></tr></table></figure>
<p><strong>推荐的示例</strong>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">d = &#123;<span class="string">'hello'</span>: <span class="string">'world'</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> d.get(<span class="string">'hello'</span>, <span class="string">'default_value'</span>) <span class="comment"># prints 'world'</span></span><br><span class="line"><span class="keyword">print</span> d.get(<span class="string">'thingy'</span>, <span class="string">'default_value'</span>) <span class="comment"># prints 'default_value'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者:</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">'hello'</span> in d:</span><br><span class="line">    <span class="keyword">print</span> d[<span class="string">'hello'</span>]</span><br></pre></td></tr></table></figure>
<h3 id="操作列表的简便方法"><a href="#操作列表的简便方法" class="headerlink" title="操作列表的简便方法"></a>操作列表的简便方法</h3><p><a href="http://docs.python.org/tutorial/datastructures.html#list-comprehensions" target="_blank" rel="noopener">列表推导式</a> 提供了一个强大并且简洁的方法来对列表价进行操作。除此之外，<a href="http://docs.python.org/library/functions.html#map" target="_blank" rel="noopener"><code>map()</code></a> 和 <a href="http://docs.python.org/library/functions.html#filter" target="_blank" rel="noopener"><code>filter()</code></a>  函数在列表的操作上也是非常简洁的。</p>
<p><strong>坏</strong>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Filter elements greater than 4</span></span><br><span class="line">a = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">b = []</span><br><span class="line"><span class="keyword">for</span> i in a:</span><br><span class="line">    <span class="keyword">if</span> i &gt; <span class="number">4</span>:</span><br><span class="line">        b.append(i)</span><br></pre></td></tr></table></figure>
<p><strong>好</strong>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">b = [i <span class="keyword">for</span> i in a <span class="keyword">if</span> i &gt; <span class="number">4</span>]</span><br><span class="line"><span class="comment"># Or:</span></span><br><span class="line">b = filter(lambda x: x &gt; <span class="number">4</span>, a)</span><br></pre></td></tr></table></figure>
<p><strong>坏</strong>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add three to all list members.</span></span><br><span class="line">a = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="keyword">for</span> i in range(len(a)):</span><br><span class="line">    a[i] += <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p><strong>好</strong>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">a = [i + <span class="number">3</span> <span class="keyword">for</span> i in a]</span><br><span class="line"><span class="comment"># Or:</span></span><br><span class="line">a = map(lambda i: i + <span class="number">3</span>, a)</span><br></pre></td></tr></table></figure>
<p>使用 <a href="http://docs.python.org/library/functions.html#enumerate" target="_blank" rel="noopener"><code>enumerate()</code></a> 来跟踪正在被处理的元素索引。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="keyword">for</span> i, item in enumerate(a):</span><br><span class="line">    <span class="keyword">print</span> i, item</span><br><span class="line"><span class="comment"># prints</span></span><br><span class="line"><span class="comment"># 0 3</span></span><br><span class="line"><span class="comment"># 1 4</span></span><br><span class="line"><span class="comment"># 2 5</span></span><br></pre></td></tr></table></figure>
<p>比起手动计数，使用<a href="http://docs.python.org/library/functions.html#enumerate" target="_blank" rel="noopener"><code>enumerate()</code></a> 函数有更好的可读性，而且，他更加适合在迭代器中使用。</p>
<h3 id="读文件"><a href="#读文件" class="headerlink" title="读文件"></a>读文件</h3><p>使用 <code>with open</code> 语法来读文件，它能够为你自动关闭文件。</p>
<p><strong>坏</strong>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f = open(<span class="string">'file.txt'</span>)</span><br><span class="line">a = f.read()</span><br><span class="line"><span class="keyword">print</span> a</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p><strong>好</strong>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">with open(<span class="string">'file.txt'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line in f:</span><br><span class="line">        <span class="keyword">print</span> line</span><br></pre></td></tr></table></figure>
<p>即使在 <code>with</code> 控制块中出现了异常，它也能确保你关闭了文件，因此，使用 <code>with</code> 语法是更加优雅的。</p>
<h3 id="行的延续"><a href="#行的延续" class="headerlink" title="行的延续"></a>行的延续</h3><p>当一个代码逻辑行的长度超过可接受的限度时，你需要将之分为多个物理行。如果行的结尾是一个反斜杠，Python 解释器会把这些连续行拼接在一起。这在某些情况下很有帮助， 但我们总是应该避免使用，因为它的脆弱性：如果在行的结尾，在反斜杠后加了空格，这会破坏代码，而且可能有意想不到的结果。</p>
<p>一个更好的解决方案是在元素周围使用括号。左边以一个未闭合的括号开头，Python 解释器会把行的结尾和下一行连接起来直到遇到闭合的括号。同样的行为适用中括号和大括号。</p>
<p><strong>糟糕</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">my_very_big_string = <span class="string">"""For a long time I used to go to bed early. Sometimes,\</span></span><br><span class="line"><span class="string">    when I had put out my candle, my eyes would close so quickly that I had not even\</span></span><br><span class="line"><span class="string">    time to say "I'm going to sleep."""</span><span class="string">"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">from some.deep.module.inside.a.module import a_nice_function, another_nice_function,\</span></span><br><span class="line"><span class="string">    yet_another_nice_function</span></span><br></pre></td></tr></table></figure>
<p><strong>优雅</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">my_very_big_string = (</span><br><span class="line">    <span class="string">"For a long time I used to go to bed early. Sometimes, "</span></span><br><span class="line">    <span class="string">"when I had put out my candle, my eyes would close so quickly "</span></span><br><span class="line">    <span class="string">"that I had not even time to say "</span>I<span class="string">'m going to sleep.""</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">from some.deep.module.inside.a.module import (</span></span><br><span class="line"><span class="string">    a_nice_function, another_nice_function, yet_another_nice_function)</span></span><br></pre></td></tr></table></figure>
<p>尽管如此，通常情况下，必须去分割一个长逻辑行意味着你同时想做太多的事，这可能影响可读性。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><blockquote>
<ul>
<li><a href="https://docs.python-guide.org/" target="_blank" rel="noopener">Python漫游指南</a></li>
</ul>
</blockquote>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2018-09-15T09:43:15.538Z" itemprop="dateUpdated">2018-09-15 17:43:15</time>
</span><br>


        
    </div>
    
    <footer>
        <a href="https://yo42.github.io">
            <img src="/img/yo.jpg" alt="Yo">
            Yo
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Technology/">Technology</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://yo42.github.io/2018/09/15/Hitchhiker’s-Guide-to-Python-Code-Style/&title=《Hitchhiker's Guide to Python-Code Style》 — Yo42&pic=https://yo42.github.io/img/yo.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://yo42.github.io/2018/09/15/Hitchhiker’s-Guide-to-Python-Code-Style/&title=《Hitchhiker's Guide to Python-Code Style》 — Yo42&source=aaa" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://yo42.github.io/2018/09/15/Hitchhiker’s-Guide-to-Python-Code-Style/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Hitchhiker's Guide to Python-Code Style》 — Yo42&url=https://yo42.github.io/2018/09/15/Hitchhiker’s-Guide-to-Python-Code-Style/&via=https://yo42.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://yo42.github.io/2018/09/15/Hitchhiker’s-Guide-to-Python-Code-Style/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2018/09/15/Hitchhiker’s-Guide-to-Python-Reading-Great-Code/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Hitchhiker&#39;s Guide to Python-Reading Great Code</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2018/09/15/Hitchhiker’s-Guide-to-Python-代码结构/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Hitchhiker&#39;s Guide to Python-代码结构</h4>
      </a>
    </div>
  
</nav>



    

















</article>



</div>

        <footer class="footer">
    <div class="top">
        

        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>Yo &copy; 2018</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> 
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://yo42.github.io/2018/09/15/Hitchhiker’s-Guide-to-Python-Code-Style/&title=《Hitchhiker's Guide to Python-Code Style》 — Yo42&pic=https://yo42.github.io/img/yo.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://yo42.github.io/2018/09/15/Hitchhiker’s-Guide-to-Python-Code-Style/&title=《Hitchhiker's Guide to Python-Code Style》 — Yo42&source=aaa" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://yo42.github.io/2018/09/15/Hitchhiker’s-Guide-to-Python-Code-Style/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Hitchhiker's Guide to Python-Code Style》 — Yo42&url=https://yo42.github.io/2018/09/15/Hitchhiker’s-Guide-to-Python-Code-Style/&via=https://yo42.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://yo42.github.io/2018/09/15/Hitchhiker’s-Guide-to-Python-Code-Style/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=https://yo42.github.io/2018/09/15/Hitchhiker’s-Guide-to-Python-Code-Style/" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>










<script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>